fs = require 'fs'
utils = require 'utils'
g = require './../global'

upload =
  showForm: (req, res) ->
    res.render 'uploadForm', {title: 'Upload'}
  validate: (req, res) ->
    file = req.files.file
    if file.size is 0
      fs.unlink file.path
      res.error 'Please choose a valid file!'
    else
      name = file.path.split '/'
      name = file.path.split '\\' if name.length is 1 # Windows
      fs.rename file.path, file.path.replace(name[name.length - 1], file.name) # keeping filename
      res.info 'Your file has been uploaded successfully!'

module.exports = upload